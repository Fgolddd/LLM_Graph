# **1\. 项目概述**

## **1.1 项目背景**

随着警务信息化的深入，积累了海量的结构化与非结构化数据（如案件记录、人员信息、时空数据、笔录文本等）。传统的数据查询方式（如SQL、关键词搜索）难以应对复杂、口语化、探索性的查询需求。

本项目旨在构建一个“警务知识制图智能体”（Police Knowledge Mapping Agent），利用大型语言模型（LLM）的强大自然语言理解（NLU）能力，将其作为连接用户与私域警务知识图谱（KG）的“智能桥梁”。

## **1.2 项目目标**

* **赋能一线：** 使警务人员能通过自然语言（而非专业查询语言）快速、准确地从海量数据中获取情报、发现线索、洞察关系。  
* **智能制图：** Agent 不仅返回文本答案，更能动态生成用于“制图”（即关系可视化）的标准化 JSON 数据，直观展现实体间的复杂关系。  
* **知识沉淀：** 将 LLM 的通用知识与警务 KG 的专业（私域）知识相结合，提供更精准、可信的查询结果。

## **1.3 核心用户**

* **一线警员：** 需要快速查询特定人员/案件/地点信息。  
* **情报分析师：** 需要进行复杂的团伙分析、轨迹碰撞、关系挖掘。  
* **指挥决策者：** 需要宏观态势感知和特定事件的关联分析。

## **1.4 项目范围**

* **输入：** 支持用户通过 Web 界面输入的自然语言查询（如：“张三和李四有什么关系？”“查一下上周在A区出现的所有红色可疑车辆”）。  
* **处理：** Agent 智能体负责理解查询意图、提取关键信息、查询知识图谱、整合结果。  
* **输出：**  
  1. **可视化JSON：** 优先输出用于前端图谱渲染的 JSON 结构。  
  2. **辅助文本：** 对查询结果的自然语言总结。  
* **(非本期范围)：**  
  * 私域知识图谱的**构建**（假定已存在或正在构建）。  
  * 前端可视化界面的**深度开发**（本项目仅定义其所需的数据接口）。

# **2\. 详细需求**

## **2.1 功能需求**

| 模块 | 功能点 | 详细描述 |
| :---- | :---- | :---- |
| **1\. 自然语言交互** | 用户输入 | 提供一个简洁的 Web 聊天/查询界面，允许用户输入自然语言问题。 |
|  | 上下文理解 | （进阶）支持多轮对话，Agent 能理解上下文关联（如：用户问“他还有其他同伙吗？”，“他”指代上一轮查询的主体）。 |
| **2\. 意图与实体识别** | 关键信息提取 | 借助 LLM 准确识别用户查询中的核心实体（如：人名、地名、车牌号、案件编号）、时间、空间以及查询的**意图**（是查询关系、查询属性还是时空分析）。 |
|  | 复杂意图拆解 | 能够将复杂的查询（如：“张三的同伙中，有哪些人上周去过A网吧？”）拆解为多个子任务（1. 查张三的同伙 2\. 查A网吧上周访客 3\. 求交集）。 |
| **3\. 知识图谱查询** | 查询语句生成 | Agent 必须能将提取出的意图和实体，**动态生成**针对私域知识图谱的查询语言（如 Neo4j 的 Cypher、SPARQL 或其他图数据库的查询 API）。 |
|  | 私域知识适配 | Agent 必须了解（通过 Prompt 或 Fine-tuning）知识图谱的 Schema（即有哪些实体类型、哪些关系类型），以生成正确的查询。 |
|  | 数据安全 | 所有查询必须在私域网络内完成，LLM（特别是公有云 LLM）不应接触到查询返回的**具体数据**，只应处理查询的**结构**和**元数据**。 |
| **4\. 结果生成与格式化** | **制图JSON生成** | **（核心）** Agent 将从 KG 获取的原始数据（如节点列表、关系列表），整合成标准化的、用于前端可视化的 JSON 格式。 |
|  | JSON 结构定义 | 必须定义清晰的 JSON Schema，至少包含 nodes (节点) 和 links (边) 两大数组，且结构与目标制图工具（如 G6）兼容。 |
|  | 自然语言总结 | LLM 根据查询结果，生成一段简明的自然语言回答，辅助用户理解图谱。 |

## **2.2 非功能需求**

| 类别 | 详细描述 |
| :---- | :---- |
| **1\. 准确性** | **（最高优先级）** 实体识别的准确率 \> 95%。关系查询的准确性必须 100% 依赖知识图谱的返回结果，LLM 不得“幻觉”或“猜测”不存在的关系。 |
| **2\. 安全性** | **（最高优先级）** 必须支持私有化部署。如使用外部 LLM API，必须对数据进行严格的脱敏和分离处理。所有数据传输必须加密。 |
| **3\. 性能** | 对于简单查询，从输入到返回 JSON 的端到端延迟应 \< 3秒。对于复杂分析查询，应 \< 10秒。 |
| **4\. 可扩展性** | 知识图谱的 Schema 更新时，Agent 应能（通过配置或微调）快速适应新的实体和关系类型。 |

## **2.3 数据需求 (JSON 示例)**

Agent 需返回的目标 JSON 结构（以 G6/ECharts Graph 为例）：

{  
  "summary": "张三目前被识别为李四的同案犯，两人均在 2023年5月1日 访问过 飞翔网吧。",  
  "graphData": {  
    "nodes": \[  
      {  
        "id": "p1",  
        "name": "张三",  
        "category": "Person"  
      },  
      {  
        "id": "p2",  
        "name": "李四",  
        "category": "Person"  
      },  
      {  
        "id": "loc1",  
        "name": "飞翔网吧",  
        "category": "Location"  
      }  
    \],  
    "links": \[  
      {  
        "source": "p1",  
        "target": "p2",  
        "relation": "同案犯"  
      },  
      {  
        "source": "p1",  
        "target": "loc1",  
        "relation": "访问",  
        "properties": {  
          "time": "2023-05-01T14:30:00"  
        }  
      },  
      {  
        "source": "p2",  
        "target": "loc1",  
        "relation": "访问",  
        "properties": {  
          "time": "2023-05-01T15:10:00"  
        }  
      }  
    \]  
  }  
}  
